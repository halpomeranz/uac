version: 1.0
condition: command_exists "ssh-keygen"
output_directory: /ssh
artifacts:
  -
    description: Find SSH private keys with null passphrases and print their public keys.
    supported_os: [all]
    collector: command
    # some busybox versionsdo not support 'find -type f'
    foreach: find "/%user_home%/.ssh" | grep -v -E '(/\.ssh$|/\.ssh/authorized_keys|/\.ssh/known_hosts|/\.ssh/config|\.pub$)'
    command: ssh-keygen -P '' -y -f "%line%"
    output_directory: /ssh/%user%
    output_file: ssh-keygen_-P_-y_-f_%line%.txt
