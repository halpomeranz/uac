version: 2.4
output_directory: /memory_dump
artifacts:
  -
    description: Capture a memory image.
    supported_os: [linux]
    collector: command
    # use ./uac -D avml_max_memory=NEW_VALUE to change the default value
    condition: test `free | awk '/^Mem:/ {print $2}'` -lt %avml_max_memory=270000000%
    command: avml avml.lime
  -
    description: Collect vmlinu* and System.map* files to help build Volatility profiles.
    supported_os: [linux]
    collector: file
    path: /boot/vmlinu* /boot/System.map*

# References:
# https://www.iblue.team/memory-forensics-1/volatility-plugins/generate-custom-profile-using-btf2json
# https://www.elastic.co/security-labs/the-grand-finale-on-linux-persistence 
